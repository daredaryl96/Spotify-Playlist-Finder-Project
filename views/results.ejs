<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <header>
    <%- include('partials/header'); %>
  </header>
</head>

<body>
  <div class="container-fluid work">
    <div id='info' class="h1 text-center"></div>

    <div class="results" id='playlist-table'>
      <h1> Matching Playlists for <%= playlistTerms %></h1>

      <div class="progress">
        <div id='playlist-progress' class="progress-bar bg-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
          <span class="sr-only"></span>
        </div>
      </div>

      <!-- <button class='stop-button btn btn-primary'>  stop </button> -->
      <div class='button-row'>
        We've found
        <span class="total-playlists"> </span> matching playlists with
        a total of <span class='total-tracks'> 0 </span> tracks.
        <br>

        <div id='fetch-tracks-ready'>
          Press
          <b> Find top tracks </b> to build a playlfist of the top tracks
          across all of these playlists 
          <div class='obutton-row'>
            <button id='fetch-tracks' class='btn btn-primary btn-success btn-lg'> Find top tracks</button>
          </div>
        </div>
      </div>

      <table class="table table-striped table-bordered">
        <thead>
          <tr>
            <th style="width:5%"> # </th>
            <th style="width: 85%"> Playlist name </th>
            <th style="width:10%"> # Tracks </th>
          </tr>
        </thead>
        <tbody id="playlist-items"> </tbody>
      </table>
    </div>

    <!-- Track code for top workout tracks -->

    <div class="results" id='track-table'>
      <h1> <a id='playlist-name'>Top <span class='keywords'> </span> Tracks </a></h1>
      <div class="button-row">
        <div id='fetching-tracks'>
          Aggregating <span id='tt-total-tracks'> </span> tracks from all
          of the <%= playlistTerms %> playlists.
          <p>
            You can stop this at any time, but the longer you wait, the
            better your results.
          </p>
          <button id='stop-button' class='padded-button stop-button btn btn-primary btn-success btn-lg'>
            stop </button>
        </div>
        <div id='ready-to-save'>
          Here are the top 100 <%= playlistTerms %> tracks. You
          can save these as your own Spotify playlist by clicking the
          button.
          <br>
          <button id="save-button" class="padded-button btn btn-primary btn-success btn-lg">
            Save Playlist to Spotify</button>
        </div>
      </div>

      <div class="progress">
        <div id='track-progress' class="progress-bar bg-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">
          <span class="sr-only"></span>
        </div>
      </div>

      <label><input id='norm-for-pop' type='checkbox'> Prefer more distinctive
        <%= playlistTerms %> tracks </label>
      <table class="table table-striped table-bordered">
        <thead>
          <tr>
            <th style="width:5%"> # </th>
            <th style="width:40%"> Title </th>
            <th style="width:35%"> Artist </th>
            <th style="width:10%"> Score</th>
          </tr>
        </thead>
        <tbody id="track-items"> </tbody>
      </table>
    </div>
  </div>


  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src= "https://cdn.jsdelivr.net/npm/underscore@1.13.6/underscore-umd-min.js"></script>
  <script>
    const serverData = JSON.parse(decodeURIComponent('<%= encodeURIComponent(JSON.stringify(playlistTerms)).replace(/'/g, "&#39;").replace(/"/g, "&#34;") %>'));
  </script>
  <script>
    const accessToken = "<%= access_token %>";
    </script>
  <script src="/javascripts/playlist.js"></script>
</body>
</html>


